{% extends "layout.html" %}

{% block content %}
<h1>QnA Chat Bot</h1>
<iframe id="chat" style="width: 1200px; height: 500px;" src=''></iframe>

<script>
  var xhr = new XMLHttpRequest();
  xhr.open('GET', "https://webchat.botframework.com/api/tokens", true);
  xhr.setRequestHeader('Authorization', 'BotConnector ' + '{{ key }}');
  xhr.send();
  xhr.onreadystatechange = processRequest;

  function processRequest(e) {
    if (xhr.readyState == 4  && xhr.status == 200) {
      var response = JSON.parse(xhr.responseText);
      document.getElementById("chat").src="https://webchat.botframework.com/embed/qna-bot-web-app?t="+response
    }
  }

</script>
{% endblock %}